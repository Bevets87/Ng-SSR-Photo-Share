!function(e,t){for(var n in t)e[n]=t[n]}(exports,function(e){var t={};function n(o){if(t[o])return t[o].exports;var r=t[o]={i:o,l:!1,exports:{}};return e[o].call(r.exports,r,r.exports,n),r.l=!0,r.exports}return n.m=e,n.c=t,n.d=function(e,t,o){n.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:o})},n.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},n.t=function(e,t){if(1&t&&(e=n(e)),8&t)return e;if(4&t&&"object"==typeof e&&e&&e.__esModule)return e;var o=Object.create(null);if(n.r(o),Object.defineProperty(o,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var r in e)n.d(o,r,function(t){return e[t]}.bind(null,r));return o},n.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return n.d(t,"a",t),t},n.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},n.p="",n(n.s=3)}([function(e,t,n){"use strict";n.r(t),n.d(t,"__extends",function(){return r}),n.d(t,"__assign",function(){return s}),n.d(t,"__rest",function(){return a}),n.d(t,"__decorate",function(){return i}),n.d(t,"__param",function(){return u}),n.d(t,"__metadata",function(){return E}),n.d(t,"__awaiter",function(){return c}),n.d(t,"__generator",function(){return l}),n.d(t,"__exportStar",function(){return _}),n.d(t,"__values",function(){return d}),n.d(t,"__read",function(){return T}),n.d(t,"__spread",function(){return O}),n.d(t,"__await",function(){return f}),n.d(t,"__asyncGenerator",function(){return m}),n.d(t,"__asyncDelegator",function(){return p}),n.d(t,"__asyncValues",function(){return N}),n.d(t,"__makeTemplateObject",function(){return R}),n.d(t,"__importStar",function(){return S}),n.d(t,"__importDefault",function(){return h});
/*! *****************************************************************************
Copyright (c) Microsoft Corporation. All rights reserved.
Licensed under the Apache License, Version 2.0 (the "License"); you may not use
this file except in compliance with the License. You may obtain a copy of the
License at http://www.apache.org/licenses/LICENSE-2.0

THIS CODE IS PROVIDED ON AN *AS IS* BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY
KIND, EITHER EXPRESS OR IMPLIED, INCLUDING WITHOUT LIMITATION ANY IMPLIED
WARRANTIES OR CONDITIONS OF TITLE, FITNESS FOR A PARTICULAR PURPOSE,
MERCHANTABLITY OR NON-INFRINGEMENT.

See the Apache Version 2.0 License for specific language governing permissions
and limitations under the License.
***************************************************************************** */
var o=function(e,t){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])})(e,t)};function r(e,t){function n(){this.constructor=e}o(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)}var s=function(){return(s=Object.assign||function(e){for(var t,n=1,o=arguments.length;n<o;n++)for(var r in t=arguments[n])Object.prototype.hasOwnProperty.call(t,r)&&(e[r]=t[r]);return e}).apply(this,arguments)};function a(e,t){var n={};for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&t.indexOf(o)<0&&(n[o]=e[o]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols){var r=0;for(o=Object.getOwnPropertySymbols(e);r<o.length;r++)t.indexOf(o[r])<0&&(n[o[r]]=e[o[r]])}return n}function i(e,t,n,o){var r,s=arguments.length,a=s<3?t:null===o?o=Object.getOwnPropertyDescriptor(t,n):o;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(e,t,n,o);else for(var i=e.length-1;i>=0;i--)(r=e[i])&&(a=(s<3?r(a):s>3?r(t,n,a):r(t,n))||a);return s>3&&a&&Object.defineProperty(t,n,a),a}function u(e,t){return function(n,o){t(n,o,e)}}function E(e,t){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(e,t)}function c(e,t,n,o){return new(n||(n=Promise))(function(r,s){function a(e){try{u(o.next(e))}catch(e){s(e)}}function i(e){try{u(o.throw(e))}catch(e){s(e)}}function u(e){e.done?r(e.value):new n(function(t){t(e.value)}).then(a,i)}u((o=o.apply(e,t||[])).next())})}function l(e,t){var n,o,r,s,a={label:0,sent:function(){if(1&r[0])throw r[1];return r[1]},trys:[],ops:[]};return s={next:i(0),throw:i(1),return:i(2)},"function"==typeof Symbol&&(s[Symbol.iterator]=function(){return this}),s;function i(s){return function(i){return function(s){if(n)throw new TypeError("Generator is already executing.");for(;a;)try{if(n=1,o&&(r=2&s[0]?o.return:s[0]?o.throw||((r=o.return)&&r.call(o),0):o.next)&&!(r=r.call(o,s[1])).done)return r;switch(o=0,r&&(s=[2&s[0],r.value]),s[0]){case 0:case 1:r=s;break;case 4:return a.label++,{value:s[1],done:!1};case 5:a.label++,o=s[1],s=[0];continue;case 7:s=a.ops.pop(),a.trys.pop();continue;default:if(!(r=(r=a.trys).length>0&&r[r.length-1])&&(6===s[0]||2===s[0])){a=0;continue}if(3===s[0]&&(!r||s[1]>r[0]&&s[1]<r[3])){a.label=s[1];break}if(6===s[0]&&a.label<r[1]){a.label=r[1],r=s;break}if(r&&a.label<r[2]){a.label=r[2],a.ops.push(s);break}r[2]&&a.ops.pop(),a.trys.pop();continue}s=t.call(e,a)}catch(e){s=[6,e],o=0}finally{n=r=0}if(5&s[0])throw s[1];return{value:s[0]?s[1]:void 0,done:!0}}([s,i])}}}function _(e,t){for(var n in e)t.hasOwnProperty(n)||(t[n]=e[n])}function d(e){var t="function"==typeof Symbol&&e[Symbol.iterator],n=0;return t?t.call(e):{next:function(){return e&&n>=e.length&&(e=void 0),{value:e&&e[n++],done:!e}}}}function T(e,t){var n="function"==typeof Symbol&&e[Symbol.iterator];if(!n)return e;var o,r,s=n.call(e),a=[];try{for(;(void 0===t||t-- >0)&&!(o=s.next()).done;)a.push(o.value)}catch(e){r={error:e}}finally{try{o&&!o.done&&(n=s.return)&&n.call(s)}finally{if(r)throw r.error}}return a}function O(){for(var e=[],t=0;t<arguments.length;t++)e=e.concat(T(arguments[t]));return e}function f(e){return this instanceof f?(this.v=e,this):new f(e)}function m(e,t,n){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var o,r=n.apply(e,t||[]),s=[];return o={},a("next"),a("throw"),a("return"),o[Symbol.asyncIterator]=function(){return this},o;function a(e){r[e]&&(o[e]=function(t){return new Promise(function(n,o){s.push([e,t,n,o])>1||i(e,t)})})}function i(e,t){try{(n=r[e](t)).value instanceof f?Promise.resolve(n.value.v).then(u,E):c(s[0][2],n)}catch(e){c(s[0][3],e)}var n}function u(e){i("next",e)}function E(e){i("throw",e)}function c(e,t){e(t),s.shift(),s.length&&i(s[0][0],s[0][1])}}function p(e){var t,n;return t={},o("next"),o("throw",function(e){throw e}),o("return"),t[Symbol.iterator]=function(){return this},t;function o(o,r){t[o]=e[o]?function(t){return(n=!n)?{value:f(e[o](t)),done:"return"===o}:r?r(t):t}:r}}function N(e){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var t,n=e[Symbol.asyncIterator];return n?n.call(e):(e=d(e),t={},o("next"),o("throw"),o("return"),t[Symbol.asyncIterator]=function(){return this},t);function o(n){t[n]=e[n]&&function(t){return new Promise(function(o,r){(function(e,t,n,o){Promise.resolve(o).then(function(t){e({value:t,done:n})},t)})(o,r,(t=e[n](t)).done,t.value)})}}}function R(e,t){return Object.defineProperty?Object.defineProperty(e,"raw",{value:t}):e.raw=t,e}function S(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)Object.hasOwnProperty.call(e,n)&&(t[n]=e[n]);return t.default=e,t}function h(e){return e&&e.__esModule?e:{default:e}}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var o=n(4),r=n(5),s=n(9);t.connection=o.createConnection({host:r.config.db_host,user:r.config.db_user,password:r.config.db_password,port:r.config.db_port,database:r.config.db_database}),t.database=new s.MySqlFacade(t.connection)},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.sql=function(e){for(var t=[],n=1;n<arguments.length;n++)t[n-1]=arguments[n];for(var o=[e[0]],r=0;r<t.length;r++)o.push(t[r],e[r+1]);return o.join("")}},function(e,t,n){"use strict";var o=this;Object.defineProperty(t,"__esModule",{value:!0});var r=n(0),s=n(1);r.__awaiter(o,void 0,void 0,function(){return r.__generator(this,function(e){switch(e.label){case 0:return[4,s.database.connect()];case 1:return e.sent(),[4,s.database.setup()];case 2:return e.sent(),[4,s.database.seed({users:50,tags:50})];case 3:return e.sent(),[4,s.database.disconnect()];case 4:return e.sent(),process.exit(0),[2]}})})},function(e,t){e.exports=require("mysql")},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var o,r=n(6);n(7),n(8);o=r.prodConfig,t.config=o},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.prodConfig={port:process.env.PORT,base_url:process.env.BASE_URL,db_host:process.env.DB_HOST,db_password:process.env.DB_PASSWORD,db_user:process.env.DB_USER,db_database:process.env.DB_DATABASE,db_port:process.env.DB_PORT,session_secret:process.env.SESSION_SECRET,session_expiration:process.env.SESSION_EXPIRATION}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.devConfig={port:3e3,base_url:"http://localhost:3000",db_host:"127.0.0.1",db_password:"Smb110687!",db_user:"root",db_database:"photo_share",db_port:3306,session_secret:"Super Secret String",session_expiration:12e6}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.testConfig={port:3e3,base_url:"http://localhost:3000",db_host:"127.0.0.1",db_password:"Smb110687!",db_user:"root",db_database:"photo_share_test",db_port:3306,session_secret:"Super Secret String",session_expiration:12e6}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var o=n(0),r=n(10),s=n(11),a=n(12),i=function(){function e(e){this.connection=e}return e.prototype.dropTables=function(){return o.__awaiter(this,void 0,void 0,function(){var e=this;return o.__generator(this,function(t){switch(t.label){case 0:return[4,Promise.all(s.drops().map(function(t){return e.query(t)}))];case 1:return t.sent(),[2]}})})},e.prototype.createTables=function(){return o.__awaiter(this,void 0,void 0,function(){var e=this;return o.__generator(this,function(t){switch(t.label){case 0:return[4,Promise.all(s.creates().map(function(t){return e.query(t)}))];case 1:return t.sent(),[2]}})})},e.prototype.setup=function(){return o.__awaiter(this,void 0,void 0,function(){return o.__generator(this,function(e){switch(e.label){case 0:return[4,this.dropTables()];case 1:return e.sent(),[4,this.createTables()];case 2:return e.sent(),[2]}})})},e.prototype.getConfig=function(){return{host:this.connection.config.host,port:this.connection.config.port,database:this.connection.config.database,password:this.connection.config.password,user:this.connection.config.user}},e.prototype.getState=function(){return this.connection.state},e.prototype.connect=function(){var e=this;return new Promise(function(t,n){e.connection.connect(function(o){o&&n(o);var s=e.connection.config.database+" connected to: "+e.connection.config.host;console.log(r.default.greenBright(s)),t(s)})})},e.prototype.disconnect=function(){var e=this;return new Promise(function(t,n){e.connection.end(function(o){o&&n(o);var s=e.connection.config.database+" disconnected from: "+e.connection.config.host;console.log(r.default.redBright(s)),t(s)})})},e.prototype.query=function(e,t){var n=this;return new Promise(function(o,s){n.connection.query(e,t,function(t,n){var a=e.split("(")[0];if(t)return console.error(r.default.bgRedBright(a)),s(t);o(n)})})},e.prototype.seed=function(e){return o.__awaiter(this,void 0,void 0,function(){return o.__generator(this,function(t){switch(t.label){case 0:return[4,a.createSeed(e)];case 1:return t.sent(),[2]}})})},e}();t.MySqlFacade=i},function(e,t){e.exports=require("chalk")},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var o=n(0),r=n(2),s=r.sql(_||(_=o.__makeTemplateObject(["\nCREATE TABLE IF NOT EXISTS users (\n    id INT PRIMARY KEY AUTO_INCREMENT,\n    username CHAR(255) NOT NULL UNIQUE,\n    avatar CHAR(255),\n    password CHAR(255) NOT NULL,\n    created_at TIMESTAMP DEFAULT NOW()\n  );\n"],["\nCREATE TABLE IF NOT EXISTS users (\n    id INT PRIMARY KEY AUTO_INCREMENT,\n    username CHAR(255) NOT NULL UNIQUE,\n    avatar CHAR(255),\n    password CHAR(255) NOT NULL,\n    created_at TIMESTAMP DEFAULT NOW()\n  );\n"]))),a=r.sql(d||(d=o.__makeTemplateObject(["\nCREATE TABLE IF NOT EXISTS photos (\n    id INT PRIMARY KEY AUTO_INCREMENT,\n    image_url CHAR(255) NOT NULL,\n    user_id INT NOT NULL,\n    created_at TIMESTAMP DEFAULT NOW(),\n    FOREIGN KEY(user_id) REFERENCES users(id) ON DELETE CASCADE ON UPDATE CASCADE\n  );\n"],["\nCREATE TABLE IF NOT EXISTS photos (\n    id INT PRIMARY KEY AUTO_INCREMENT,\n    image_url CHAR(255) NOT NULL,\n    user_id INT NOT NULL,\n    created_at TIMESTAMP DEFAULT NOW(),\n    FOREIGN KEY(user_id) REFERENCES users(id) ON DELETE CASCADE ON UPDATE CASCADE\n  );\n"]))),i=r.sql(T||(T=o.__makeTemplateObject(["\nCREATE TABLE IF NOT EXISTS comments (\n    id INT PRIMARY KEY AUTO_INCREMENT,\n    comment_text TEXT NOT NULL,\n    photo_id INT NOT NULL,\n    user_id INT NOT NULL,\n    created_at TIMESTAMP DEFAULT NOW(),\n    FOREIGN KEY(photo_id) REFERENCES photos(id) ON DELETE CASCADE ON UPDATE CASCADE,\n    FOREIGN KEY(user_id) REFERENCES users(id) ON DELETE CASCADE ON UPDATE CASCADE\n  );\n"],["\nCREATE TABLE IF NOT EXISTS comments (\n    id INT PRIMARY KEY AUTO_INCREMENT,\n    comment_text TEXT NOT NULL,\n    photo_id INT NOT NULL,\n    user_id INT NOT NULL,\n    created_at TIMESTAMP DEFAULT NOW(),\n    FOREIGN KEY(photo_id) REFERENCES photos(id) ON DELETE CASCADE ON UPDATE CASCADE,\n    FOREIGN KEY(user_id) REFERENCES users(id) ON DELETE CASCADE ON UPDATE CASCADE\n  );\n"]))),u=r.sql(O||(O=o.__makeTemplateObject(["\nCREATE TABLE IF NOT EXISTS likes (\n    user_id INT NOT NULL,\n    photo_id INT NOT NULL,\n    created_at TIMESTAMP DEFAULT NOW(),\n    FOREIGN KEY(user_id) REFERENCES users(id) ON DELETE CASCADE ON UPDATE CASCADE,\n    FOREIGN KEY(photo_id) REFERENCES photos(id) ON DELETE CASCADE ON UPDATE CASCADE,\n    PRIMARY KEY(user_id, photo_id)\n  );\n"],["\nCREATE TABLE IF NOT EXISTS likes (\n    user_id INT NOT NULL,\n    photo_id INT NOT NULL,\n    created_at TIMESTAMP DEFAULT NOW(),\n    FOREIGN KEY(user_id) REFERENCES users(id) ON DELETE CASCADE ON UPDATE CASCADE,\n    FOREIGN KEY(photo_id) REFERENCES photos(id) ON DELETE CASCADE ON UPDATE CASCADE,\n    PRIMARY KEY(user_id, photo_id)\n  );\n"]))),E=r.sql(f||(f=o.__makeTemplateObject(["\nCREATE TABLE IF NOT EXISTS follows (\n    follower_id INT NOT NULL,\n    followee_id INT NOT NULL,\n    created_at TIMESTAMP DEFAULT NOW(),\n    FOREIGN KEY(follower_id) REFERENCES users(id) ON DELETE CASCADE ON UPDATE CASCADE,\n    FOREIGN KEY(followee_id) REFERENCES users(id) ON DELETE CASCADE ON UPDATE CASCADE,\n    PRIMARY KEY(follower_id, followee_id)\n  );\n"],["\nCREATE TABLE IF NOT EXISTS follows (\n    follower_id INT NOT NULL,\n    followee_id INT NOT NULL,\n    created_at TIMESTAMP DEFAULT NOW(),\n    FOREIGN KEY(follower_id) REFERENCES users(id) ON DELETE CASCADE ON UPDATE CASCADE,\n    FOREIGN KEY(followee_id) REFERENCES users(id) ON DELETE CASCADE ON UPDATE CASCADE,\n    PRIMARY KEY(follower_id, followee_id)\n  );\n"]))),c=r.sql(m||(m=o.__makeTemplateObject(["\nCREATE TABLE IF NOT EXISTS tags (\n    id INT PRIMARY KEY AUTO_INCREMENT,\n    tag_name CHAR(255) UNIQUE,\n    created_at TIMESTAMP DEFAULT NOW()\n  );\n"],["\nCREATE TABLE IF NOT EXISTS tags (\n    id INT PRIMARY KEY AUTO_INCREMENT,\n    tag_name CHAR(255) UNIQUE,\n    created_at TIMESTAMP DEFAULT NOW()\n  );\n"]))),l=r.sql(p||(p=o.__makeTemplateObject(["\nCREATE TABLE IF NOT EXISTS photo_tags (\n    tag_id INT NOT NULL,\n    photo_id INT NOT NULL,\n    FOREIGN KEY(tag_id) REFERENCES tags(id) ON DELETE CASCADE ON UPDATE CASCADE,\n    FOREIGN KEY(photo_id) REFERENCES photos(id) ON DELETE CASCADE ON UPDATE CASCADE,\n    PRIMARY KEY(tag_id, photo_id)\n  );\n"],["\nCREATE TABLE IF NOT EXISTS photo_tags (\n    tag_id INT NOT NULL,\n    photo_id INT NOT NULL,\n    FOREIGN KEY(tag_id) REFERENCES tags(id) ON DELETE CASCADE ON UPDATE CASCADE,\n    FOREIGN KEY(photo_id) REFERENCES photos(id) ON DELETE CASCADE ON UPDATE CASCADE,\n    PRIMARY KEY(tag_id, photo_id)\n  );\n"])));t.creates=function(){return[s,a,i,u,E,c,l]};var _,d,T,O,f,m,p,N,R,S,h,I,g,C,A=r.sql(N||(N=o.__makeTemplateObject(["\nDROP TABLE IF EXISTS users;\n"],["\nDROP TABLE IF EXISTS users;\n"]))),b=r.sql(R||(R=o.__makeTemplateObject(["\nDROP TABLE IF EXISTS photos;\n"],["\nDROP TABLE IF EXISTS photos;\n"]))),L=r.sql(S||(S=o.__makeTemplateObject(["\nDROP TABLE IF EXISTS comments;\n"],["\nDROP TABLE IF EXISTS comments;\n"]))),F=r.sql(h||(h=o.__makeTemplateObject(["\nDROP TABLE IF EXISTS likes;\n"],["\nDROP TABLE IF EXISTS likes;\n"]))),v=r.sql(I||(I=o.__makeTemplateObject(["\nDROP TABLE IF EXISTS follows;\n"],["\nDROP TABLE IF EXISTS follows;\n"]))),y=r.sql(g||(g=o.__makeTemplateObject(["\nDROP TABLE IF EXISTS tags;\n"],["\nDROP TABLE IF EXISTS tags;\n"]))),M=r.sql(C||(C=o.__makeTemplateObject(["\nDROP TABLE IF EXISTS photo_tags;\n"],["\nDROP TABLE IF EXISTS photo_tags;\n"])));t.drops=function(){return[M,y,v,F,L,b,A]}},function(e,t,n){"use strict";var o=this;Object.defineProperty(t,"__esModule",{value:!0});var r=n(0),s=n(13),a=n(14),i=n(15),u=n(16),E=n(17),c=n(18),l=n(19),_=n(20),d=n(21),T=function(e){return"https://picsum.photos/350/225?image="+e},O=function(e){var t=Math.floor(Math.random()*e.length);return e.splice(t,1)},f=function(e){var t=e.length;return e[Math.floor(Math.random()*t)]};t.createFakeUser=function(e){return[e,"test-"+e+"@test.com","password-"+e,s.internet.avatar()]},t.createFakePhoto=function(e,t){return[e,T(e),t]},t.createFakeComment=function(e,t,n){return[e,s.lorem.text(),t,n]},t.createFakeTag=function(e){return[e,s.lorem.word()+"-"+e]},t.createFakeUsers=function(e){for(var n=[],o=1;o<=e;)n.push(t.createFakeUser(o)),o++;return n},t.createFakePhotos=function(e){var n=[],o=1;return e.forEach(function(e){for(var r=e[0],s=f([0,2,5]);s>0;)n.push(t.createFakePhoto(o++,r)),s--}),n},t.createFakeComments=function(e,n){var o=[],r=1;return n.forEach(function(n){for(var s=n[2],a=e.filter(function(e){return e[0]!==s}),i=n[0],u=f([0,2,5,7]);u>0;){var E=O(a)[0][0];o.push(t.createFakeComment(r++,i,E)),u--}}),o},t.createFakeFollows=function(e){var t=[];return e.forEach(function(n){for(var o=n[0],r=e.filter(function(e){return e[0]!==o}),s=f([0,2,5]);s>0;){var a=O(r)[0][0];t.push([a,o]),s--}}),t},t.createFakeLikes=function(e,t){var n=[];return t.forEach(function(t){for(var o=t[2],r=e.filter(function(e){return e[0]!==o}),s=t[0],a=f([0,2,5]);a>0;){var i=O(r)[0][0];n.push([i,s]),a--}}),n},t.createFakeTags=function(e){for(var n=[],o=1;o<=e;)n.push(t.createFakeTag(o++));return n},t.createFakePhotoTags=function(e,t){var n=[];return t.forEach(function(t){for(var o=t[0],r=e.slice(),s=f([0,2,5]);s>0;){var a=O(r)[0][0];n.push([a,o]),s--}}),n},t.removeIds=function(e){return e.map(function(e){var t=e.slice();return t.splice(0,1),t})};var m=function(e){return e.map(function(e){var t=e.slice(),n=a.hashSync(t[2],10);return t.splice(2,1,n),t})};t.createSeed=function(e){var n=e.users,s=void 0===n?20:n,a=e.tags,T=void 0===a?20:a;return r.__awaiter(o,void 0,void 0,function(){var e,n,o,a,O,f,p,N;return r.__generator(this,function(r){switch(r.label){case 0:return s=s<10?10:s,T=T<10?10:T,e=t.createFakeUsers(s),n=t.createFakePhotos(e),o=t.createFakeComments(e,n),a=t.createFakeFollows(e),O=t.createFakeLikes(e,n),f=t.createFakeTags(T),p=t.createFakePhotoTags(f,n),N={users:t.removeIds(m(e)),photos:t.removeIds(n),follows:a,comments:t.removeIds(o),tags:t.removeIds(f),likes:O,photo_tags:p},[4,i.createManyUsers(N.users)];case 1:return r.sent(),[4,u.createManyPhotos(N.photos)];case 2:return r.sent(),[4,E.createManyComments(N.comments)];case 3:return r.sent(),[4,c.createManyLikes(N.likes)];case 4:return r.sent(),[4,l.createManyFollows(N.follows)];case 5:return r.sent(),[4,_.createManyTags(N.tags)];case 6:return r.sent(),[4,d.createManyPhotoTags(N.photo_tags)];case 7:return r.sent(),[2]}})})}},function(e,t){e.exports=require("faker")},function(e,t){e.exports=require("bcrypt")},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var o,r,s,a,i,u,E,c,l,_,d,T,O=n(0),f=n(2),m=n(1),p=function(){return function(){}}();t.User=p,t.getUserById=function(e){return m.database.query(f.sql(o||(o=O.__makeTemplateObject(["SELECT id, username, password, avatar FROM users WHERE id = ?"],["SELECT id, username, password, avatar FROM users WHERE id = ?"]))),[e]).then(function(e){return Promise.resolve(e[0])})},t.createUser=function(e){return m.database.query(f.sql(r||(r=O.__makeTemplateObject(["INSERT INTO users SET ?"],["INSERT INTO users SET ?"]))),e).then(function(e){return t.getUserById(e.insertId)})},t.createManyUsers=function(e){return m.database.query(f.sql(s||(s=O.__makeTemplateObject(["INSERT INTO users (username, password, avatar) VALUES ?"],["INSERT INTO users (username, password, avatar) VALUES ?"]))),[e])},t.deleteUser=function(e){return m.database.query(f.sql(a||(a=O.__makeTemplateObject(["DELETE FROM users WHERE users.id = ?"],["DELETE FROM users WHERE users.id = ?"]))),[e])},t.updateUser=function(e,t){return m.database.query(f.sql(i||(i=O.__makeTemplateObject(["UPDATE users SET username = ?, avatar = ? WHERE id = ?"],["UPDATE users SET username = ?, avatar = ? WHERE id = ?"]))),[t.username,t.avatar,e])},t.changeUserPassword=function(e,t){return m.database.query(f.sql(u||(u=O.__makeTemplateObject(["UPDATE users SET password = ? WHERE id = ?"],["UPDATE users SET password = ? WHERE id = ?"]))),[t,e])},t.getUserByUsername=function(e){return m.database.query(f.sql(E||(E=O.__makeTemplateObject(["SELECT id, username, password, avatar FROM users WHERE username = ?"],["SELECT id, username, password, avatar FROM users WHERE username = ?"]))),[e]).then(function(e){return Promise.resolve(e[0])})},t.getUsersNotInIds=function(e,t){void 0===t&&(t={limit:20,offset:0});return Promise.all([m.database.query(f.sql(l||(l=O.__makeTemplateObject(["\n    SELECT "," FROM users\n    WHERE users.id NOT IN (?)\n    LIMIT ? OFFSET ?\n  "],["\n    SELECT "," FROM users\n    WHERE users.id NOT IN (?)\n    LIMIT ? OFFSET ?\n  "])),"users.id, users.username, users.avatar "),[e,t.limit,t.offset]),m.database.query(f.sql(c||(c=O.__makeTemplateObject(["\n    SELECT COUNT(*) AS users_count FROM users WHERE users.id NOT IN (?)\n  "],["\n    SELECT COUNT(*) AS users_count FROM users WHERE users.id NOT IN (?)\n  "]))),[e])]).then(function(e){var t=e[0],n=e[1][0].users_count;return Promise.resolve({data:t,count:n})})},t.getUsersInIds=function(e,t){void 0===t&&(t={limit:20,offset:0});return Promise.all([m.database.query(f.sql(d||(d=O.__makeTemplateObject(["\n    SELECT "," FROM users\n    WHERE users.id IN (?)\n    LIMIT ? OFFSET ?\n  "],["\n    SELECT "," FROM users\n    WHERE users.id IN (?)\n    LIMIT ? OFFSET ?\n  "])),"users.id, users.username, users.avatar "),[e,t.limit,t.offset]),m.database.query(f.sql(_||(_=O.__makeTemplateObject(["\n    SELECT COUNT(*) AS users_count FROM users WHERE users.id IN (?)\n  "],["\n    SELECT COUNT(*) AS users_count FROM users WHERE users.id IN (?)\n  "]))),[e])]).then(function(e){var t=e[0],n=e[1][0].users_count;return Promise.resolve({data:t,count:n})})},t.searchUsersByUsername=function(e){var t=e.q.concat("%");return m.database.query(f.sql(T||(T=O.__makeTemplateObject(["\n    SELECT "," FROM users\n    WHERE LOWER(username) LIKE ?\n    LIMIT 20 OFFSET 0\n  "],["\n    SELECT "," FROM users\n    WHERE LOWER(username) LIKE ?\n    LIMIT 20 OFFSET 0\n  "])),"users.id, users.username, users.avatar "),[t])}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var o=n(0),r=n(2),s=n(1),a=function(){return function(){}}();t.Photo=a;var i,u,E,c,l,_,d,T,O,f,m="photos.id, photos.image_url, photos.created_at, users.id AS user_id, users.username, users.avatar ";t.getPhotoById=function(e){return s.database.query(r.sql(i||(i=o.__makeTemplateObject(["\n    SELECT "," FROM photos\n    INNER JOIN users ON photos.user_id = users.id\n    WHERE photos.id = ?\n    "],["\n    SELECT "," FROM photos\n    INNER JOIN users ON photos.user_id = users.id\n    WHERE photos.id = ?\n    "])),m),[e]).then(function(e){return Promise.resolve(e[0])})},t.createManyPhotos=function(e){return s.database.query(r.sql(u||(u=o.__makeTemplateObject(["INSERT INTO photos (image_url, user_id) VALUES ?"],["INSERT INTO photos (image_url, user_id) VALUES ?"]))),[e])},t.createPhoto=function(e){return s.database.query(r.sql(E||(E=o.__makeTemplateObject(["INSERT INTO photos SET ?"],["INSERT INTO photos SET ?"]))),e).then(function(e){return t.getPhotoById(e.insertId)})},t.getPhotosInUserIds=function(e,t){void 0===t&&(t={limit:10,offset:0});return Promise.all([s.database.query(r.sql(l||(l=o.__makeTemplateObject(["\n    SELECT "," FROM photos\n    INNER JOIN users ON photos.user_id = users.id\n    WHERE photos.user_id IN (?)\n    GROUP BY photos.id\n    ORDER BY photos.created_at DESC\n    LIMIT ? OFFSET ?\n  "],["\n    SELECT "," FROM photos\n    INNER JOIN users ON photos.user_id = users.id\n    WHERE photos.user_id IN (?)\n    GROUP BY photos.id\n    ORDER BY photos.created_at DESC\n    LIMIT ? OFFSET ?\n  "])),m),[e,t.limit,t.offset]),s.database.query(r.sql(c||(c=o.__makeTemplateObject(["\n    SELECT COUNT(*) AS photos_count FROM photos\n     WHERE photos.user_id IN (?)\n  "],["\n    SELECT COUNT(*) AS photos_count FROM photos\n     WHERE photos.user_id IN (?)\n  "]))),[e])]).then(function(e){var t=e[0],n=e[1][0].photos_count;return Promise.resolve({data:t,count:n})})},t.getPhotosNotInUserIds=function(e,t){void 0===t&&(t={limit:10,offset:0});return Promise.all([s.database.query(r.sql(d||(d=o.__makeTemplateObject(["\n    SELECT "," FROM photos\n    INNER JOIN users ON photos.user_id = users.id\n    WHERE photos.user_id NOT IN (?)\n    ORDER BY created_at DESC\n    LIMIT ? OFFSET ?\n  "],["\n    SELECT "," FROM photos\n    INNER JOIN users ON photos.user_id = users.id\n    WHERE photos.user_id NOT IN (?)\n    ORDER BY created_at DESC\n    LIMIT ? OFFSET ?\n  "])),m),[e,t.limit,t.offset]),s.database.query(r.sql(_||(_=o.__makeTemplateObject(["\n    SELECT COUNT(*) AS photos_count FROM photos\n    WHERE photos.user_id NOT IN (?)\n  "],["\n    SELECT COUNT(*) AS photos_count FROM photos\n    WHERE photos.user_id NOT IN (?)\n  "]))),[e])]).then(function(e){var t=e[0],n=e[1][0].photos_count;return Promise.resolve({data:t,count:n})})},t.getPhotosByUserId=function(e,t){void 0===t&&(t={limit:10,offset:0});return Promise.all([s.database.query(r.sql(O||(O=o.__makeTemplateObject(["\n    SELECT "," FROM photos\n    INNER JOIN users ON photos.user_id = users.id\n    WHERE photos.user_id = ?\n    ORDER BY created_at DESC\n    LIMIT ? OFFSET ?\n  "],["\n    SELECT "," FROM photos\n    INNER JOIN users ON photos.user_id = users.id\n    WHERE photos.user_id = ?\n    ORDER BY created_at DESC\n    LIMIT ? OFFSET ?\n  "])),m),[e,t.limit,t.offset]),s.database.query(r.sql(T||(T=o.__makeTemplateObject(["\n    SELECT COUNT(*) AS photos_count FROM photos\n    WHERE photos.user_id = ?\n  "],["\n    SELECT COUNT(*) AS photos_count FROM photos\n    WHERE photos.user_id = ?\n  "]))),[e])]).then(function(e){var t=e[0],n=e[1][0].photos_count;return Promise.resolve({data:t,count:n})})},t.deletePhoto=function(e,t){return s.database.query(r.sql(f||(f=o.__makeTemplateObject(["\n    DELETE FROM photos WHERE photos.id = ? AND photos.user_id = ?\n  "],["\n    DELETE FROM photos WHERE photos.id = ? AND photos.user_id = ?\n  "]))),[e,t])}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var o,r,s,a,i,u,E,c,l=n(0),_=n(2),d=n(1),T=function(){return function(){}}();t.Comment=T,t.getCommentById=function(e){return d.database.query(_.sql(o||(o=l.__makeTemplateObject(["\n    SELECT "," FROM comments\n    INNER JOIN users ON comments.user_id = users.id\n    WHERE comments.id = ?\n  "],["\n    SELECT "," FROM comments\n    INNER JOIN users ON comments.user_id = users.id\n    WHERE comments.id = ?\n  "])),"comments.id, comments.comment_text, users.username "),[e]).then(function(e){return Promise.resolve(e[0])})},t.getCommentsByPhotoId=function(e,t){void 0===t&&(t={limit:5,offset:0});return Promise.all([d.database.query(_.sql(s||(s=l.__makeTemplateObject(["\n    SELECT "," FROM comments\n    INNER JOIN users ON comments.user_id = users.id\n    WHERE comments.photo_id = ?\n    ORDER BY comments.created_at DESC\n    LIMIT ? OFFSET ?\n  "],["\n    SELECT "," FROM comments\n    INNER JOIN users ON comments.user_id = users.id\n    WHERE comments.photo_id = ?\n    ORDER BY comments.created_at DESC\n    LIMIT ? OFFSET ?\n  "])),"comments.id, comments.comment_text, users.username "),[e,t.limit,t.offset]),d.database.query(_.sql(r||(r=l.__makeTemplateObject(["\n    SELECT COUNT(*) AS comments_count FROM comments\n    WHERE comments.photo_id = ?\n  "],["\n    SELECT COUNT(*) AS comments_count FROM comments\n    WHERE comments.photo_id = ?\n  "]))),[e])]).then(function(e){var t=e[0],n=e[1][0].comments_count;return Promise.resolve({data:t,count:n})})},t.createComment=function(e){return d.database.query(_.sql(a||(a=l.__makeTemplateObject(["INSERT INTO comments SET ?"],["INSERT INTO comments SET ?"]))),e).then(function(e){return t.getCommentById(e.insertId)})},t.createManyComments=function(e){return d.database.query(_.sql(i||(i=l.__makeTemplateObject(["INSERT INTO comments (comment_text, photo_id, user_id) VALUES ?"],["INSERT INTO comments (comment_text, photo_id, user_id) VALUES ?"]))),[e])},t.deleteComment=function(e){return d.database.query(_.sql(u||(u=l.__makeTemplateObject(["DELETE FROM comments WHERE comments.id = ?"],["DELETE FROM comments WHERE comments.id = ?"]))),[e])},t.getCommentsCount=function(){return d.database.query(_.sql(E||(E=l.__makeTemplateObject(["SELECT COUNT(*) AS comments_count FROM comments"],["SELECT COUNT(*) AS comments_count FROM comments"])))).then(function(e){return Promise.resolve(e[0].comments_count)})},t.getCommentsCountByPhotoId=function(e){return d.database.query(_.sql(c||(c=l.__makeTemplateObject(["SELECT COUNT(*) AS comments_count FROM comments WHERE comments.photo_id = ?"],["SELECT COUNT(*) AS comments_count FROM comments WHERE comments.photo_id = ?"]))),[e]).then(function(e){return Promise.resolve(e[0].comments_count)})}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var o,r,s,a,i,u,E,c,l,_,d=n(0),T=n(2),O=n(1),f=function(){return function(){}}();t.Like=f,t.getLikesByPhotoId=function(e,t){void 0===t&&(t={limit:20,offset:0});return Promise.all([O.database.query(T.sql(r||(r=d.__makeTemplateObject(["\n    SELECT "," FROM likes\n    INNER JOIN users ON likes.user_id = users.id\n    WHERE likes.photo_id = ?\n    ORDER BY likes.created_at\n    LIMIT ? OFFSET ?\n  "],["\n    SELECT "," FROM likes\n    INNER JOIN users ON likes.user_id = users.id\n    WHERE likes.photo_id = ?\n    ORDER BY likes.created_at\n    LIMIT ? OFFSET ?\n  "])),"users.id, users.username, users.avatar "),[e,t.limit,t.offset]),O.database.query(T.sql(o||(o=d.__makeTemplateObject(["\n    SELECT COUNT(*) AS likes_count FROM likes\n    WHERE likes.photo_id = ?\n  "],["\n    SELECT COUNT(*) AS likes_count FROM likes\n    WHERE likes.photo_id = ?\n  "]))),[e])]).then(function(e){var t=e[0],n=e[1][0].likes_count;return Promise.resolve({data:t,count:n})})},t.createLike=function(e){return O.database.query(T.sql(s||(s=d.__makeTemplateObject(["INSERT INTO likes SET ?"],["INSERT INTO likes SET ?"]))),e)},t.createManyLikes=function(e){return O.database.query(T.sql(a||(a=d.__makeTemplateObject(["INSERT INTO likes (user_id, photo_id) VALUES ?"],["INSERT INTO likes (user_id, photo_id) VALUES ?"]))),[e])},t.getLikesCount=function(){return O.database.query(T.sql(i||(i=d.__makeTemplateObject(["SELECT COUNT(*) AS likes_count FROM likes"],["SELECT COUNT(*) AS likes_count FROM likes"])))).then(function(e){return Promise.resolve(e[0].likes_count)})},t.getLikesCountByPhotoId=function(e){return O.database.query(T.sql(u||(u=d.__makeTemplateObject(["SELECT COUNT(*) AS likes_count FROM likes WHERE likes.photo_id = ?"],["SELECT COUNT(*) AS likes_count FROM likes WHERE likes.photo_id = ?"]))),[e]).then(function(e){return Promise.resolve(e[0].likes_count)})},t.getUserLikes=function(e,t){return O.database.query(T.sql(E||(E=d.__makeTemplateObject(["SELECT COUNT(*) AS likes_count FROM likes WHERE user_id = ? AND photo_id = ?"],["SELECT COUNT(*) AS likes_count FROM likes WHERE user_id = ? AND photo_id = ?"]))),[e,t]).then(function(e){return Promise.resolve(!!e[0].likes_count)})},t.removeLike=function(e,t){return O.database.query(T.sql(c||(c=d.__makeTemplateObject(["DELETE FROM likes WHERE user_id = ? AND photo_id = ?"],["DELETE FROM likes WHERE user_id = ? AND photo_id = ?"]))),[e,t])},t.getLikesByUserId=function(e,t){return Promise.all([O.database.query(T.sql(_||(_=d.__makeTemplateObject(["\n    SELECT "," FROM likes\n    INNER JOIN users ON likes.user_id = users.id\n    WHERE likes.user_id = ?\n    ORDER BY likes.created_at\n    LIMIT ? OFFSET ?\n  "],["\n    SELECT "," FROM likes\n    INNER JOIN users ON likes.user_id = users.id\n    WHERE likes.user_id = ?\n    ORDER BY likes.created_at\n    LIMIT ? OFFSET ?\n  "])),"users.id, users.username, users.avatar, likes.photo_id"),[e,t.limit,t.offset]),O.database.query(T.sql(l||(l=d.__makeTemplateObject(["\n    SELECT COUNT(*) AS likes_count FROM likes\n    WHERE likes.photo_id = ?\n  "],["\n    SELECT COUNT(*) AS likes_count FROM likes\n    WHERE likes.photo_id = ?\n  "]))),[e])]).then(function(e){var t=e[0],n=e[1][0].likes_count;return Promise.resolve({data:t,count:n})})}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var o,r,s,a,i,u,E,c,l=n(0),_=n(2),d=n(1),T=function(){return function(){}}();t.Follow=T,t.getAllFollowerIds=function(e){return d.database.query(_.sql(o||(o=l.__makeTemplateObject(["\n    SELECT follower_id FROM follows\n    WHERE followee_id = ?\n  "],["\n    SELECT follower_id FROM follows\n    WHERE followee_id = ?\n  "]))),[e]).then(function(e){return Promise.resolve(e.map(function(e){return e.follower_id}))})},t.getAllFolloweeIds=function(e){return d.database.query(_.sql(r||(r=l.__makeTemplateObject(["\n    SELECT followee_id FROM follows\n    WHERE follower_id = ?\n  "],["\n    SELECT followee_id FROM follows\n    WHERE follower_id = ?\n  "]))),[e]).then(function(e){return Promise.resolve(e.map(function(e){return e.followee_id}))})},t.createFollow=function(e){return d.database.query(_.sql(s||(s=l.__makeTemplateObject(["INSERT INTO follows SET ?"],["INSERT INTO follows SET ?"]))),e)},t.createManyFollows=function(e){return d.database.query(_.sql(a||(a=l.__makeTemplateObject(["INSERT INTO follows (follower_id, followee_id) VALUES ?"],["INSERT INTO follows (follower_id, followee_id) VALUES ?"]))),[e])},t.removeFollow=function(e,t){return d.database.query(_.sql(i||(i=l.__makeTemplateObject(["DELETE FROM follows WHERE follower_id = ? AND followee_id = ?"],["DELETE FROM follows WHERE follower_id = ? AND followee_id = ?"]))),[e,t])},t.getUserFollows=function(e,t){return d.database.query(_.sql(u||(u=l.__makeTemplateObject(["\n    SELECT COUNT(*) AS follows_count FROM follows\n    WHERE follower_id = ? AND followee_id = ?"],["\n    SELECT COUNT(*) AS follows_count FROM follows\n    WHERE follower_id = ? AND followee_id = ?"]))),[e,t]).then(function(e){return Promise.resolve(!!e[0].follows_count)})},t.getFollowersCount=function(e){return d.database.query(_.sql(E||(E=l.__makeTemplateObject(["\n    SELECT COUNT(*) AS followers_count FROM follows\n    WHERE followee_id = ?\n  "],["\n    SELECT COUNT(*) AS followers_count FROM follows\n    WHERE followee_id = ?\n  "]))),[e]).then(function(e){return Promise.resolve(e[0].followers_count)})},t.getFollowingCount=function(e){return d.database.query(_.sql(c||(c=l.__makeTemplateObject(["\n    SELECT COUNT(*) AS following_count FROM follows\n    WHERE follower_id = ?\n  "],["\n    SELECT COUNT(*) AS following_count FROM follows\n    WHERE follower_id = ?\n  "]))),[e]).then(function(e){return Promise.resolve(e[0].following_count)})}},function(e,t,n){"use strict";var o=this;Object.defineProperty(t,"__esModule",{value:!0});var r,s,a,i,u,E,c,l=n(0),_=n(2),d=n(1),T=function(){return function(){}}();t.Tag=T,t.getTagById=function(e){return d.database.query(_.sql(r||(r=l.__makeTemplateObject(["SELECT id, tag_name FROM tags WHERE id = ?"],["SELECT id, tag_name FROM tags WHERE id = ?"]))),[e]).then(function(e){return Promise.resolve(e[0])})},t.createTag=function(e){return d.database.query(_.sql(s||(s=l.__makeTemplateObject(["INSERT INTO tags SET ?"],["INSERT INTO tags SET ?"]))),e).then(function(e){return t.getTagById(e.insertId)})},t.createManyTags=function(e){return l.__awaiter(o,void 0,void 0,function(){return l.__generator(this,function(t){return[2,d.database.query(_.sql(a||(a=l.__makeTemplateObject(["INSERT INTO tags (tag_name) VALUES ?"],["INSERT INTO tags (tag_name) VALUES ?"]))),[e.map(function(e){return[e]})]).catch(function(){return Promise.resolve()})]})})},t._getDuplicates=function(e){return d.database.query(_.sql(i||(i=l.__makeTemplateObject(["SELECT tag_name FROM tags WHERE tags.tag_name IN (?)"],["SELECT tag_name FROM tags WHERE tags.tag_name IN (?)"]))),e).then(function(e){return Promise.resolve(e.reduce(function(e,t){return e[t.tag_name]=1,e},{}))})},t.deleteTag=function(e){return d.database.query(_.sql(u||(u=l.__makeTemplateObject(["DELETE FROM tags WHERE tags.id = ?"],["DELETE FROM tags WHERE tags.id = ?"]))),[e])},t.getTagsCount=function(){return d.database.query(_.sql(E||(E=l.__makeTemplateObject(["SELECT COUNT(*) AS tags_count FROM tags"],["SELECT COUNT(*) AS tags_count FROM tags"])))).then(function(e){var t=e[0].tags_count;return Promise.resolve(t)})},t.getTagByTagName=function(e){return d.database.query(_.sql(c||(c=l.__makeTemplateObject(["\n    SELECT tags.id, tags.tag_name FROM tags WHERE tags.tag_name = ?\n  "],["\n    SELECT tags.id, tags.tag_name FROM tags WHERE tags.tag_name = ?\n  "]))),[e])}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var o,r,s,a,i,u,E=n(0),c=n(2),l=n(1),_=function(){return function(){}}();t.PhotoTag=_,t.createPhotoTag=function(e){return l.database.query(c.sql(o||(o=E.__makeTemplateObject(["INSERT INTO photo_tags SET ?"],["INSERT INTO photo_tags SET ?"]))),e)},t.createManyPhotoTags=function(e){return l.database.query(c.sql(r||(r=E.__makeTemplateObject(["INSERT INTO photo_tags (tag_id, photo_id) VALUES ?"],["INSERT INTO photo_tags (tag_id, photo_id) VALUES ?"]))),[e])},t.getPhotoTagsByPhotoId=function(e){return l.database.query(c.sql(s||(s=E.__makeTemplateObject(["SELECT tags.id, tags.tag_name FROM photo_tags\n    INNER JOIN tags ON photo_tags.tag_id = tags.id\n    WHERE photo_tags.photo_id = ?"],["SELECT tags.id, tags.tag_name FROM photo_tags\n    INNER JOIN tags ON photo_tags.tag_id = tags.id\n    WHERE photo_tags.photo_id = ?"]))),[e])},t.searchTagsByTagname=function(e){var t=e.q.concat("%");return l.database.query(c.sql(a||(a=E.__makeTemplateObject(["\n    SELECT tags.id, tags.tag_name, COUNT(photos.id) AS posts FROM photo_tags\n    INNER JOIN tags ON photo_tags.tag_id = tags.id\n    INNER JOIN photos ON photo_tags.photo_id = photos.id\n    WHERE tags.tag_name LIKE ?\n    GROUP BY tags.id\n    LIMIT 20 OFFSET 0\n  "],["\n    SELECT tags.id, tags.tag_name, COUNT(photos.id) AS posts FROM photo_tags\n    INNER JOIN tags ON photo_tags.tag_id = tags.id\n    INNER JOIN photos ON photo_tags.photo_id = photos.id\n    WHERE tags.tag_name LIKE ?\n    GROUP BY tags.id\n    LIMIT 20 OFFSET 0\n  "]))),[t])},t.getPhotosByTagId=function(e,t){return Promise.all([l.database.query(c.sql(u||(u=E.__makeTemplateObject(["\n    SELECT tags.id, tags.tag_name, photos.id AS photo_id, photos.image_url, photos.user_id, photos.created_at FROM photo_tags\n    INNER JOIN tags ON photo_tags.tag_id = tags.id\n    INNER JOIN photos ON photo_tags.photo_id = photos.id\n    WHERE tags.id = ?\n    GROUP BY photos.id\n    ORDER BY photos.created_at DESC\n    LIMIT ? OFFSET ?\n  "],["\n    SELECT tags.id, tags.tag_name, photos.id AS photo_id, photos.image_url, photos.user_id, photos.created_at FROM photo_tags\n    INNER JOIN tags ON photo_tags.tag_id = tags.id\n    INNER JOIN photos ON photo_tags.photo_id = photos.id\n    WHERE tags.id = ?\n    GROUP BY photos.id\n    ORDER BY photos.created_at DESC\n    LIMIT ? OFFSET ?\n  "]))),[e,t.limit,t.offset]),l.database.query(c.sql(i||(i=E.__makeTemplateObject(["\n    SELECT COUNT(photos.id) AS photos_count FROM photo_tags\n    INNER JOIN tags ON photo_tags.tag_id = tags.id\n    INNER JOIN photos ON photo_tags.photo_id = photos.id\n    WHERE tags.id = ?\n  "],["\n    SELECT COUNT(photos.id) AS photos_count FROM photo_tags\n    INNER JOIN tags ON photo_tags.tag_id = tags.id\n    INNER JOIN photos ON photo_tags.photo_id = photos.id\n    WHERE tags.id = ?\n  "]))),[e])]).then(function(e){var t=e[0],n=e[1][0].photos_count;return Promise.resolve({data:t,count:n})})}}]));